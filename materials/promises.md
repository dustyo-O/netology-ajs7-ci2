---
title: Promises, async/await
slideOptions:
  transition: slide
---

# AJS. Promises, async/await

###### tags: `netology` `advanced js`

---

## ÐŸÐ»Ð°Ð½ Ð·Ð°Ð½ÑÑ‚Ð¸Ñ
1. ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
1. Promises
1. async/await
1. Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°

---

## Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´

JS Ð¸ÑÐ¿Ð¾Ð»Ð½ÑÐµÑ‚ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð² Ð¾Ð´Ð½Ð¾Ð¼ Ð¿Ð¾Ñ‚Ð¾ÐºÐµ*, Ñ‚.Ðµ. Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð¾Ð´Ð½Ñƒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð² ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñƒ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

Ð­Ñ‚Ð¾ Ð½Ð°Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð·Ñ€ÐµÐ½Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹, Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ñ… Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¾Ð¹ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹.

---

## Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´

```javascript=
const response = getResponse(...);
const data = processResponse(...);
```

Ð•ÑÐ»Ð¸ Ð¾Ð±Ð° Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‚ ÑÐ¾Ð±Ð¾Ð¹ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ñ‚Ð¾ Ð½Ð¸ÐºÐ°ÐºÐ¸Ñ… Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ð½Ðµ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ°ÐµÑ‚.

---

## Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸

ÐžÐ±Ð° Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¼Ð¾Ð³ÑƒÑ‚ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÐ¾Ð±Ð¾Ð¹ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸.

Ð•ÑÐ»Ð¸ Ð² ÑÑ‚Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð½Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ Ð´Ñ€ÑƒÐ³Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ, Ñ‚Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑÑ "Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ", Ñ‚.Ðº. JS Ð±ÑƒÐ´ÐµÑ‚ Ð¶Ð´Ð°Ñ‚ÑŒ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð°.

---

## ÐœÐ½Ð¾Ð³Ð¾Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ

ÐœÐ½Ð¾Ð³Ð¸Ðµ ÑÐ·Ñ‹ÐºÐ¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽÑ‚ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ Ð¿Ð¾Ñ‚Ð¾ÐºÐ°Ð¼Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ.

Ð¢Ñ€Ð°Ð´Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð¾, ÑÑ‚Ð¾Ñ‚ Ñ€Ð°Ð·Ð´ÐµÐ» ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð¾Ð´Ð½Ð¸Ð¼ Ð¸Ð· ÑÐ°Ð¼Ñ‹Ñ… ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… Ð¸ Ð¿Ð¾Ð´Ð²ÐµÑ€Ð¶ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÑˆÐ¸Ð±ÐºÐ°Ð¼.

---

## Ð—Ð°Ð´Ð°Ñ‡Ð°

ÐŸÐµÑ€ÐµÐ´ Ð½Ð°Ð¼Ð¸ ÑÑ‚Ð¾Ð¸Ñ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°: Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð²Ñ‹Ð´Ð°Ð² ÐµÐ¼Ñƒ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚.

ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð° Ð½Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ?

> ÐÐµ Ð²ÑÐµÐ³Ð´Ð° Ñƒ Ð½Ð°Ñ ÐµÑÑ‚ÑŒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ. Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾, Ð¼Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ API Ð’ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ðµ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÑ‚Ð¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð’ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ðµ Ð²Ñ€ÑÐ´Ð»Ð¸ Ð²Ð°Ð¼ Ð´Ð°Ð´ÑƒÑ‚ Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð½Ð° Ð¸Ñ… ÑÐµÑ€Ð²ÐµÑ€Ð°Ñ… ÑÐ²Ð¾ÑŽ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ :smile: 

---

## ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´

ÐŸÐ¾ÑÑ‚Ð¾Ð¼Ñƒ Ð² JS Ð¿Ñ€Ð¸ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ "ÑƒÐ¿Ñ€Ð¾ÑÑ‚Ð¸Ñ‚ÑŒ" Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¿Ð¾Ð´Ð¾Ð±Ð½Ñ‹Ñ… Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹, Ð½Ðµ Ð¿Ñ€Ð¸Ð±ÐµÐ³Ð°Ñ Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¿Ñ€Ð¸Ð¼Ð¸Ñ‚Ð¸Ð²Ð¾Ð² Ð¼Ð½Ð¾Ð³Ð¾Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸.

---

## Callbacks

Callbacks - Ð¿Ð¾Ð´Ñ…Ð¾Ð´, Ð¿Ñ€Ð¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ ÐºÐ°ÐºÐ¾Ð³Ð¾-Ð»Ð¸Ð±Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸) Ð»Ð¸Ð±Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÐºÐ°ÐºÐ¾Ð³Ð¾-Ñ‚Ð¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°, Ð¼Ñ‹ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‘Ð¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ (callback), ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð½ÑƒÐ¶Ð½Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð¿Ð¾ÑÐ»Ðµ Ð½Ð°ÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ, Ð»Ð¸Ð±Ð¾ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°.

```javascript=
function getResponse(args, callback) {
  // Ð³Ð´Ðµ-Ñ‚Ð¾ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ getResponse
  const response = ...;
  
  callback(response);
}

getResponse(..., (response) => { // Ð½Ð°Ñˆ callback
  ...
});
```

:::info
Ð’Ð°Ð¶Ð½Ð¾: Ð¿Ð¾Ð½ÑÑ‚Ð¸Ðµ callback Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾ÑÑ‚Ð¸. Callback - ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÐµÐ¹, Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°ÐµÐ¼Ð¾Ð¹ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, Ð´Ð»Ñ Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÑ‚Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸. Ð”Ð»Ñ Built-in Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² ÑÑ‚Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÐºÐ°ÐºÐ¸Ñ…-Ð»Ð¸Ð±Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð´Ð»Ñ Array - Ð¿Ð¾Ð¸ÑÐº, ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð¸ Ñ‚.Ð´.).
:::

---

## Callbacks

ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð½Ð° MDN Ð·Ð²ÑƒÑ‡Ð¸Ñ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼: "A callback function is a function passed into another function as an argument, which is then invoked inside the outer function to complete some kind of routine or action."

---

## Callback Hell

```javascript=
function getResponse(args, callback) {
  // Ð³Ð´Ðµ-Ñ‚Ð¾ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ getResponse
  const response = ...;
  
  callback(response);
}

function processResponse(args, callback) {
  // Ð³Ð´Ðµ-Ñ‚Ð¾ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ processResponse
  const data = ...;
  
  callback(data);
}

getResponse(..., (response) => { // Ð½Ð°Ñˆ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ callback
  processResponse(..., (data) => { // Ð½Ð°Ñˆ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ callback
  
  });
});
```

---

## Callback Hell

ÐÐµÑ‚Ñ€ÑƒÐ´Ð½Ð¾ ÑÐµÐ±Ðµ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð±ÑƒÐ´ÐµÑ‚ ÐµÑÐ»Ð¸ Ð²Ñ‹Ð·Ð¾Ð²Ð¾Ð² Ñƒ Ð½Ð°Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð½Ðµ 2, Ð° Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ 10.

Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° ÐºÐ¾Ð´Ð° Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ð² Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ñ… Ð²Ñ‹Ð·Ð¾Ð²Ð¾Ð².

Ð”Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð´Ð°Ð¶Ðµ Ð¿Ñ€Ð¸Ð´ÑƒÐ¼Ð°Ð»Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ‚ÐµÑ€Ð¼Ð¸Ð½ - [Callback Hell](http://callbackhell.com).

---

## ÐšÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ

Ð¡Ñ€ÐµÐ´Ð°, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð±ÑƒÐ´ÐµÑ‚ Ð¸ÑÐ¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð²Ð°Ñˆ JS-ÐºÐ¾Ð´ (Ð±ÑƒÐ´ÑŒ ÑÑ‚Ð¾ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð¸Ð»Ð¸ Node.js) ÑÐ°Ð¼Ð° Ð±ÐµÑ€Ñ‘Ñ‚ Ð½Ð° ÑÐµÐ±Ñ Ð·Ð°Ð±Ð¾Ñ‚Ñƒ Ð¿Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ callback'Ð° Ð² Ð½ÑƒÐ¶Ð½Ñ‹Ð¹ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

---

## Promises

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Promise (Ð¾Ð±ÐµÑ‰Ð°Ð½Ð¸Ñ) - Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‰Ð¸Ð¹ ÑƒÐ¿Ñ€Ð¾ÑÑ‚Ð¸Ñ‚ÑŒ Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð° Ð¸ Ñ€ÐµÑˆÐ¸Ñ‚ÑŒ Ñ€ÑÐ´ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ callback'Ð¾Ð².

---

## Promises

```javascript=
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => {
    ...
  });
}
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð½Ðµ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‚ callback Ð´Ð»Ñ Ð²Ñ‹Ð·Ð¾Ð²Ð°, Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ Ð¾Ð±ÑŠÐµÐºÑ‚ ÐºÐ»Ð°ÑÑÐ° `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¸ Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð³Ñ€Ð°Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡ÐµÐ²ÑƒÑŽ Ñ€Ð¾Ð»ÑŒ.

---

## Ð˜Ð´ÐµÑ Promise

ÐšÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¸Ð´ÐµÑ `Promise` - ÑÑ‚Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð²ÑÐµÐ³Ð¾ Ð² Ñ‚Ñ€Ñ‘Ñ… ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÑÑ…:
* `pending`
* `fulfilled`
* `rejected`

Ð˜ ÐµÐ´Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾Ð¹Ñ‚Ð¸ Ñ `Promise` - ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ð¸Ð· ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ `pending` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled` Ð¸Ð»Ð¸ `rejected`.

ÐŸÑ€Ð¾Ð¸Ð·Ð¾Ð¹Ñ‚Ð¸ ÑÑ‚Ð¾Ñ‚ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ð¼Ð¾Ð¶ÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·.

---

## Ð˜Ð´ÐµÑ Promise

ÐŸÐ¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ, Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‰Ð°Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½ÑƒÑŽ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÑ‚Ð¾Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ð¾Ð½Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¸ "Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚" Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÑÑ‚Ð¾Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸.

---

## Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Promise

```javascript=
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve('value');
    }, 500);
  });
}

const responsePromise = getResponse(args);
```

`resolve`, `reject` - Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ð¿Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ÑÑ‰Ð¸Ðµ `Promise` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfiled` Ð¸Ð»Ð¸ `rejected`, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾.

---

## then 

ÐœÐµÑ‚Ð¾Ð´, Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‰Ð¸Ð¹ callback, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒÑÑ Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° `Promise` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled`:

```javascript=
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
});
```

---

## ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº

ÐŸÑ€Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ðµ `Promise` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `rejected` Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ callback, ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ð¹ Ð²Ñ‚Ð¾Ñ€Ñ‹Ð¼ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð¼ Ð² Ð¼ÐµÑ‚Ð¾Ð´Ðµ `then`:

```javascript=
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}, (error) => { // callback for rejected
  ...
});
```

---

## catch

ÐœÐµÑ‚Ð¾Ð´, Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‰Ð¸Ð¹ callback, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒÑÑ Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° `Promise` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `rejected` Ð¸Ð»Ð¸ Ð²Ñ‹Ð±Ñ€Ð°ÑÑ‹Ð²Ð°Ð½Ð¸Ñ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ (ÐµÑÐ»Ð¸ Ð¾Ð½Ð¾ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð¾ Ð² ÐºÐ¾Ð´Ðµ `then`):

```javascript=
const responsePromise = getResponse(args);
responsePromise.catch((error) => {
  ...
});
```

---

## then + catch

```javascript=
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}).catch((error) => {
// calback for `rejected` Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð² `then`

});
```

---

## finally

ÐœÐµÑ‚Ð¾Ð´, Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‰Ð¸Ð¹ callback, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒÑÑ Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° `Promise` Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled` Ð¸Ð»Ð¸ `rejected` (Ð²Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¾Ð³Ð¾, Ð² ÐºÐ°ÐºÐ¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¿ÐµÑ€ÐµÑˆÑ‘Ð» `Promise`):

```javascript=
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}).catch((error) => {
  ...
}).finally(() => {
  // final actions
});
```

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð´Ð° Ð² `then` Ð¸ `catch`

---

## Promisification

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `Promise` Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð»Ð¾ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÑ‹Ð²Ð°Ð½Ð¸Ñ ÑÑ‚Ð°Ñ€Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°.

ÐŸÐµÑ€ÐµÐ¿Ð¸ÑÑ‹Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð° (Ð±ÐµÐ· `Promise`) Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `Promise` Ð¾Ð±Ð¾Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð¾Ð¼ **Promisification**

---

## Ð¦ÐµÐ¿Ð¾Ñ‡ÐºÐ¸ Promise

`Promise` Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÑÑ‚ÑŒ Ð² Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÐ¸, ÐµÑÐ»Ð¸ `then` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ñ‚Ð¾Ð¶Ðµ `Promise`:

```javascript=
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => { ... });
}

function processResponse(response) {
  // Do something
  return new Promise((resolve, reject) => { ... });
}

getResponse(args).then((response) => {
  return processResponse(response);
}).then((data) => {
  // do something
}).catch((error) => {
  // handle error
}).finally(() => {
  // final handlings
})
```

---

## Ð˜Ñ‚Ð¾Ð³Ð¸ Ð¿Ð¾ Promise

Ð—Ð°Ñ‡ÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹ `Promise`, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð½Ðµ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð²ÑÑ‘ Ð½Ð° callback'Ð°Ñ…?

> 1. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `Promise` ÑƒÐ¿Ñ€Ð¾Ñ‰Ð°ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼ ÐºÐ¾Ð´Ð¾Ð¼, Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Callback Hell
> 1. Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ API Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð¾ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ `Promise`, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð²Ð°Ð¶Ð½Ð¾ ÑƒÐ¼ÐµÑ‚ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¾Ñ‚ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚
> 1. `Promise` Ð½Ðµ Ð¾Ñ‚Ð¼ÐµÐ½ÑÑŽÑ‚ callback'Ð¸ - Ð¸Ñ… Ð²ÑÑ‘ Ñ€Ð°Ð²Ð½Ð¾ Ð¿Ñ€Ð¸Ð´Ñ‘Ñ‚ÑÑ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ

---

## Ð˜Ñ‚Ð¾Ð³Ð¸ Ð¿Ð¾ Promise

Ð’ ÐºÐ°ÐºÐ¾Ð¼ Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ `then`, `catch`?

> Ð’ Ñ‚Ð¾Ð¼, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð·Ð°Ð¿Ð¸ÑÐ°Ð½Ñ‹

```javascript=
const promise = getResponse();
promise.then((data) => {
  throw new Error(); // <- Ð²Ñ‹Ð±Ñ€Ð¾Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¸, ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð¿Ð¾ Ð±Ð»Ð¾ÐºÑƒ `catch`
}).catch((error) => {
  console.log('first error happened:');
})
.then((data) => {
  console.log(data); // <- ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ `then`
}).catch((error) => {
  console.log('second error happened:'); // <- Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
});

// undefined
```

ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ñ‚Ð°Ðº?

---

## then Ð¸ catch

ÐœÐµÑ‚Ð¾Ð´Ñ‹ `then` Ð¸ `catch` Ñ‚Ð¾Ð¶Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ `Promise`, Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ñ‡ÐµÐ¼Ñƒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÐ¸ `Promise`.

ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ `then`:
* `then` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`
* ÐµÑÐ»Ð¸ Ð¸Ð· `then` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ, Ñ‚Ð¾ Ð¾Ð½Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled`
* ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾, ÐµÑÐ»Ð¸ Ð¸Ð· `then` Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ, Ñ‚Ð¾ Ð² `Promise` ÐºÐ»Ð°Ð´Ñ‘Ñ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ `undefined`
* ÐµÑÐ»Ð¸ Ð² `then` Ð²Ñ‹Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾ÑˆÐ¸Ð±ÐºÐ°, Ñ‚Ð¾ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `rejected`
* ÐµÑÐ»Ð¸ Ð¸Ð· `then` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ `Promise`, Ñ‚Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð²Ñ‹Ð·Ð¾Ð²Ñ‹ `then` Ð¸ `catch` Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ

---

## then Ð¸ catch

ÐœÐµÑ‚Ð¾Ð´Ñ‹ `then` Ð¸ `catch` Ñ‚Ð¾Ð¶Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ `Promise`, Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ñ‡ÐµÐ¼Ñƒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÐ¸ `Promise`.

ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ `catch`:
* `catch` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`
* ÐµÑÐ»Ð¸ Ð¸Ð· `catch` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ, Ñ‚Ð¾ Ð¾Ð½Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled`
* ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾, ÐµÑÐ»Ð¸ Ð¸Ð· `catch` Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ, Ñ‚Ð¾ Ð² `Promise` ÐºÐ»Ð°Ð´Ñ‘Ñ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ `undefined`
* ÐµÑÐ»Ð¸ Ð² `catch` Ð²Ñ‹Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾ÑˆÐ¸Ð±ÐºÐ°, Ñ‚Ð¾ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `rejected`
* ÐµÑÐ»Ð¸ Ð¸Ð· `catch` Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ `Promise`, Ñ‚Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð²Ñ‹Ð·Ð¾Ð²Ñ‹ `then` Ð¸ `catch` Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ

---

## Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Promise

ÐšÐ»Ð°ÑÑ `Promise` ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÐµÑ‰Ñ‘ Ñ€ÑÐ´ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð², Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ñ… ÑƒÐ´Ð¾Ð±Ð½ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:
* `Promise.all(iterable)` - Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled`, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð²ÑÐµ `Promise` Ð¸Ð· `iterable` Ð¿ÐµÑ€ÐµÑˆÐ»Ð¸ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfiled` (Ð»Ð¸Ð±Ð¾ Ð² `iterable` Ð½Ðµ Ð±Ñ‹Ð»Ð¾ `Promise` )
* `Promise.race(iterable)` - Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled` Ð¸Ð»Ð¸ `rejected` ÐºÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð»ÑŽÐ±Ð¾Ð¹ Ð¸Ð· `Promise`, ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‰Ð¸Ñ…ÑÑ Ð² `iterable` Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² `fullfilled` Ð¸Ð»Ð¸ `rejected`

---

## async/await

Ð¡ `Promise` Ð²ÑÑ‘ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾, Ð½Ð¾ ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼Ñ‹ ÐµÑ‰Ñ‘ Ð±Ð¾Ð»ÐµÐµ ÑƒÐ¿Ñ€Ð¾ÑÑ‚Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾Ñ‚ ÐºÐ¾Ð´?

ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑÐ»Ð¾Ð²Ð° `async`/`await` Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‚ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ `Promise` Ð±Ð¾Ð»ÐµÐµ ÑƒÐ´Ð¾Ð±Ð½Ð¾Ð¹.

Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ ÑÑ€Ð°Ð·Ñƒ Ð½Ð° Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ðµ.

---

## async/await

```javascript=
const response = await getResponse(args);
const data = await processResponse(response);
```

Ð˜ ÑÑ‚Ð¾ Ð²Ð¼ÐµÑÑ‚Ð¾:
```javascript=
const promise = getResponse();
promise.then((response) => {
  return processResponse(response);
.then((data) => {
  // Do something
});
```

Ð£Ð´Ð¾Ð±Ð½Ð¾?

---

## ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð¸ finally

Ð—Ð´ÐµÑÑŒ Ñ‚Ð¾Ð¶Ðµ Ð²ÑÑ‘ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑŽ `try...catch...finally`

```javascript=
try {
  const response = await getResponse(args);
  const data = await processResponse(response);
} catch {
  ...
} finally {
  ...
}
```

---

## async

ÐÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `await` ÐµÑÑ‚ÑŒ Ð¾Ð´Ð½Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ: `await` Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ `async` Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹:

```javascript=
(async () => {
  try {
    const response = await getResponse(args);
    const data = await processResponse(response);
  } catch {
    ...
  } finally {
    ...
  }
})();
```

---

## async

ÐšÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ ÑÐ»Ð¾Ð²Ð¾ `async` Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚, Ñ‡Ñ‚Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾ - Ñ‚.Ðµ. Ð²ÑÐµÐ³Ð´Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `Promise`, Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð³Ð»ÑÐ´ÐµÑ‚ÑŒ ÐºÐ°Ðº ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ.

Ð§Ñ‚Ð¾ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ *ÐºÐ°Ðº ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ*? Ð­Ñ‚Ð¾ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚, Ñ‡Ñ‚Ð¾ ÐµÑÐ»Ð¸ Ð²Ñ‹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚Ðµ Ð¸Ð· Ñ‚Ð°ÐºÐ¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ, Ñ‚Ð¾ Ð¾Ð½Ð¾ Ð·Ð°Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð² `Promise`.

ÐšÑ€Ð¾Ð¼Ðµ Ñ‚Ð¾Ð³Ð¾, Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `await` Ð²Ð½ÑƒÑ‚Ñ€Ð¸ `async` Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð´Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð° `Promise` (`await` ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑÑ Ð¿ÐµÑ€ÐµÐ´ `Promise`) Ð² ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ `fullfilled` Ð¸Ð»Ð¸ `rejected`.

## Ð”Ð»Ñ Ñ‡ÐµÐ³Ð¾ ÑÑ‚Ð¾?

Ð”Ð»Ñ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ ÐºÐ¾Ð´Ð°, ÑÑ€Ð°Ð²Ð½Ð¸Ð¼:
```javascript=
(async () => {
  try {
    // Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ `Promise`
    const response = await getResponse(args);
    // Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ `Promise`
    const data = await processResponse(response);
  } catch {
    ...
  } finally {
    ...
  }
})();
```

```javascript=
getResponse(args).then((response) => {
  return processResponse(response);
}).then((data) => {
  // do something
}).catch((error) => {
  // handle error
}).finally(() => {
  // final handlings
})
```

ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚ Ð½Ð°Ð¼Ð½Ð¾Ð³Ð¾ Ð±Ð¾Ð»ÐµÐµ Ð»Ð°ÐºÐ¾Ð½Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð·Ð° ÑÑ‡Ñ‘Ñ‚ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ð½Ð°Ð³Ñ€Ð¾Ð¼Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ `then`, `catch`.

---

## async/await

ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð±Ñ‹ Ñ‚Ð¾Ð³Ð´Ð° ÑÐ¾Ð²ÑÐµÐ¼ Ð½Ðµ Ð¾Ñ‚ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ Ð¾Ñ‚ `Promise`?

> ÐŸÐ¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð² Ð¾ÑÐ½Ð¾Ð²Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ `async`/`await` Ð»ÐµÐ¶Ð°Ñ‚ `Promise`. `async`/`await` Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð½Ð°Ð¼ Ð»Ð¸ÑˆÑŒ ÑƒÐ´Ð¾Ð±Ð½ÐµÐµ Ñ Ð½Ð¸Ð¼Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ.

---

## Babel

```shell=
$ npm install @babel/polyfill
```

Ð’ `.babelrc`:
```json=
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "useBuiltIns": "usage"
      }
    ]
  ]
}
```

---

## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°

Jest Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÑ‚ Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð½Ñ‹Ñ… Ð½Ð°Ð¼Ð¸ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² (callback'Ð¸, `Promise`, `async`/`await`) ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ. Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð¸Ñ….

---

## Callbacks

```javascript=
test('should call our callback', (done) => { // <- ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚
  getData((data) => {
    expect(data).toBe(...);
    done(); // <- ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°
  });
});
```

`done` - Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ, Ð²Ñ‹Ð·Ð¾Ð²Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Jest Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ð¶Ð¸Ð´Ð°Ñ‚ÑŒ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸, Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ `jest.setTimeout` (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ - 5 ÑÐµÐºÑƒÐ½Ð´).

Ð•ÑÐ»Ð¸ Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð½Ðµ Ð±ÑƒÐ´ÐµÑ‚, Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð¼ `FAIL`

![](https://i.imgur.com/TCCl9UF.png)

---

## Promise Ð¸ async/await

ÐŸÑ€Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ñ `Promise` Ð¸ `async`/`await` Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ (Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ ÐºÐ°Ðº Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾):
```javascript=
test('should work with promise and async/await', async () => { // <- async
  const data = await getData();
  expect(data).toBe(...);
});
```

---

## Error handling

```javascript=
test('should handle errors', async () => { // <- async
  // <- ÑÐ¾Ð¾Ð±Ñ‰Ð°ÐµÐ¼ Jest, Ñ‡Ñ‚Ð¾ Ñƒ Ð½Ð°Ñ Ð¾Ð´Ð¸Ð½ assert, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ
  expect.assertions(1);
  try {
    const data = await getData();
  } catch (e) {
    expect(e).toBe(...);
  }
});
```

---

## Ð˜Ñ‚Ð¾Ð³Ð¸

Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ Ð¼Ñ‹ Ñ Ð²Ð°Ð¼Ð¸ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ»Ð¸ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¼Ð½Ð¾Ð³Ð¾ Ð²Ð°Ð¶Ð½Ñ‹Ñ… Ð²ÐµÑ‰ÐµÐ¹:
1. ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
1. Promises
1. async/await
1. Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°

---

## Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ! Ð’Ñ€ÐµÐ¼Ñ Ð·Ð°Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ ðŸ™‚

---