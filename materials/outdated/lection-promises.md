---
title: Promises, async/await
slideOptions:
  transition: slide
---

# AJS. Promises, async/await

###### tags: `netology` `advanced js`

---

## –ü–ª–∞–Ω –∑–∞–Ω—è—Ç–∏—è
1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
1. Promises
1. async/await
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

---

## –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥

JS –∏—Å–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ* (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç), —Ç.–µ. –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

–≠—Ç–æ –Ω–∞—Å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

---

## –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥

```javascript
const response = getResponse(...);
const data = processResponse(...);
```

–ï—Å–ª–∏ –æ–±–∞ –≤—ã–∑–æ–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –±—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç–æ –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç.

---

## –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

–û–±–∞ –≤—ã–∑–æ–≤–∞ –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å–æ–±–æ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

–ï—Å–ª–∏ –≤ —ç—Ç–æ –≤—Ä–µ–º—è –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Å–æ–±—ã—Ç–∏—è, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è "–æ—á–µ—Ä–µ–¥—å", —Ç.–∫. JS –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞.

---

## –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

–ú–Ω–æ–≥–∏–µ —è–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ, —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∏ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞–º.

---

## –ó–∞–¥–∞—á–∞

–ü–µ—Ä–µ–¥ –Ω–∞–º–∏ —Å—Ç–æ–∏—Ç —Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞: –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–¥–∞–≤ –µ–º—É –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç.

–ü–æ—á–µ–º—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?

> –ù–µ –≤—Å–µ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É. –í–æ–∑–º–æ–∂–Ω–æ, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º API –í–∫–æ–Ω—Ç–∞–∫—Ç–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ê —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ –≤—Ä—è–¥–ª–∏ –≤–∞–º –¥–∞–¥—É—Ç –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö —Å–≤–æ—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é :smile: 

---

## –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥

–ü–æ—ç—Ç–æ–º—É –≤ JS –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç "—É–ø—Ä–æ—Å—Ç–∏—Ç—å" –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–¥–æ–±–Ω—ã—Ö –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –Ω–µ –ø—Ä–∏–±–µ–≥–∞—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏.

---

## Callbacks

Callbacks - –ø–æ–¥—Ö–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–Ω–∏—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏) –ª–∏–±–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –º—ã –ø–µ—Ä–µ–¥–∞—ë–º —Ñ—É–Ω–∫—Ü–∏—é (callback), –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è, –ª–∏–±–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.

```javascript
function getResponse(args, callback) {
  // –≥–¥–µ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ getResponse
  const response = ...;
  
  callback(response);
}

getResponse(..., (response) => { // –Ω–∞—à callback
  ...
});
```

:::info
–í–∞–∂–Ω–æ: –ø–æ–Ω—è—Ç–∏–µ callback –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏. Callback - —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –¥–ª—è –≤—ã–∑–æ–≤–∞ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –î–ª—è Built-in –æ–±—ä–µ–∫—Ç–æ–≤ —ç—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è Array - –ø–æ–∏—Å–∫, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ —Ç.–¥.).
:::

---

## Callbacks

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ MDN –∑–≤—É—á–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: "A callback function is a function passed into another function as an argument, which is then invoked inside the outer function to complete some kind of routine or action."

---

## Callback Hell

```javascript
function getResponse(args, callback) {
  // –≥–¥–µ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ getResponse
  const response = ...;
  
  callback(response);
}

function processResponse(args, callback) {
  // –≥–¥–µ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ processResponse
  const data = ...;
  
  callback(data);
}

getResponse(..., (response) => { // –Ω–∞—à –ø–µ—Ä–≤—ã–π callback
  processResponse(..., (data) => { // –Ω–∞—à –≤—Ç–æ—Ä–æ–π callback
  
  });
});
```

---

## Callback Hell

–ù–µ—Ç—Ä—É–¥–Ω–æ —Å–µ–±–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, —á—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –≤—ã–∑–æ–≤–æ–≤ —É –Ω–∞—Å –±—É–¥–µ—Ç –Ω–µ 2, –∞ —Ö–æ—Ç—è –±—ã 10.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.

–î–ª—è —ç—Ç–æ–≥–æ –¥–∞–∂–µ –ø—Ä–∏–¥—É–º–∞–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω - [Callback Hell](http://callbackhell.com).

---

## –ö–ª—é—á–µ–≤–æ–µ

–°—Ä–µ–¥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤–∞—à JS-–∫–æ–¥ (–±—É–¥—å —ç—Ç–æ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ Node.js) —Å–∞–º–∞ –±–µ—Ä—ë—Ç –Ω–∞ —Å–µ–±—è –∑–∞–±–æ—Ç—É –ø–æ –≤—ã–∑–æ–≤—É –≤–∞—à–µ–≥–æ callback'–∞ –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

---

## Promises

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Promise (–æ–±–µ—â–∞–Ω–∏—è) - –º–µ—Ö–∞–Ω–∏–∑–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —É–ø—Ä–æ—Å—Ç–∏—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ —Ä–µ—à–∏—Ç—å —Ä—è–¥ –ø—Ä–æ–±–ª–µ–º callback'–æ–≤.

---

## Promises

```javascript
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => {
    ...
  });
}
```

–¢–µ–ø–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç callback –¥–ª—è –≤—ã–∑–æ–≤–∞, –∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ `Promise`, –∫–æ—Ç–æ—Ä—ã–π –∏ –±—É–¥–µ—Ç –∏–≥—Ä–∞—Ç—å –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å.

---

## –ò–¥–µ—è Promise

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è `Promise` - —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤—Å–µ–≥–æ –≤ —Ç—Ä—ë—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö:
* `pending`
* `fulfilled`
* `rejected`

–ò –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Å `Promise` - —ç—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è `pending` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled` –∏–ª–∏ `rejected`.

–ü—Ä–æ–∏–∑–æ–π—Ç–∏ —ç—Ç–æ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.

---

## –ò–¥–µ—è Promise

–ü–æ—Å–∫–æ–ª—å–∫—É —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –Ω–µ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`, –∫–æ—Ç–æ—Ä—ã–π –∏ "–∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç" —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

---

## –°–æ–∑–¥–∞–Ω–∏–µ Promise

```javascript
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve('value');
    }, 500);
  });
}

const responsePromise = getResponse(args);
```

`resolve`, `reject` - —Ñ—É–Ω–∫—Ü–∏–∏, –≤—ã–∑—ã–≤–∞–µ–º—ã–µ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥—è—â–∏–µ `Promise` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfiled` –∏–ª–∏ `rejected`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

---

## then 

–ú–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π callback, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å—Å—è –≤ —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ `Promise` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled`:

```javascript
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
});
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ `Promise` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `rejected` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è callback, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤—Ç–æ—Ä—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –≤ –º–µ—Ç–æ–¥–µ `then`:

```javascript
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}, (error) => { // callback for rejected
  ...
});
```

---

## catch

–ú–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π callback, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å—Å—è –≤ —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ `Promise` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `rejected` –∏–ª–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–µ—Å–ª–∏ –æ–Ω–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –≤ –∫–æ–¥–µ `then`):

```javascript
const responsePromise = getResponse(args);
responsePromise.catch((error) => {
  ...
});
```

---

## then + catch

```javascript
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}).catch((error) => {
// calback for `rejected` –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤ `then`

});
```

---

## finally

–ú–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π callback, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤—ã–∑–≤–∞—Ç—å—Å—è –≤ —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ `Promise` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled` –∏–ª–∏ `rejected` (–≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –≤ –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—à—ë–ª `Promise`):

```javascript
const responsePromise = getResponse(args);
responsePromise.then((response) => {
  ...
}).catch((error) => {
  ...
}).finally(() => {
  // final actions
});
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –≤ `then` –∏ `catch`

---

## Promisification

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Promise` –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞.

–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞ (–±–µ–∑ `Promise`) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Promise` –æ–±–æ–∑–Ω–∞—á–∞—é—Ç —Ç–µ—Ä–º–∏–Ω–æ–º **Promisification**

---

## –¶–µ–ø–æ—á–∫–∏ Promise

`Promise` –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –≤ —Ü–µ–ø–æ—á–∫–∏, –µ—Å–ª–∏ `then` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∂–µ `Promise`:

```javascript
function getResponse(args) {
  // Do something
  return new Promise((resolve, reject) => { ... });
}

function processResponse(response) {
  // Do something
  return new Promise((resolve, reject) => { ... });
}

getResponse(args).then((response) => {
  return processResponse(response);
}).then((data) => {
  // do something
}).catch((error) => {
  // handle error
}).finally(() => {
  // final handlings
})
```

---

## –ò—Ç–æ–≥–∏ –ø–æ Promise

–ó–∞—á–µ–º –Ω—É–∂–Ω—ã `Promise`, –ø–æ—á–µ–º—É –Ω–µ –¥–µ–ª–∞—Ç—å –≤—Å—ë –Ω–∞ callback'–∞—Ö?

> 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Promise` —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∫–æ–¥–æ–º, –ø–æ–º–æ–≥–∞—è –∏–∑–±–µ–∂–∞—Ç—å Callback Hell
> 1. –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ API –Ω–∞–ø–∏—Å–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Promise`, –ø–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–æ —É–º–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
> 1. `Promise` –Ω–µ –æ—Ç–º–µ–Ω—è—é—Ç callback'–∏ - –∏—Ö –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–∏–¥—ë—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
> 1. –ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è `pending` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fulfilled` –∏–ª–∏ `rejected` –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**
> 1. Promise –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å

---

## –ò—Ç–æ–≥–∏ –ø–æ Promise

–í –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `then`, `catch`?

> –í —Ç–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø–∏—Å–∞–Ω—ã

```javascript
const promise = getResponse();
promise.then((data) => {
  throw new Error(); // <- –≤—ã–±—Ä–æ—Å –æ—à–∏–±–∫–∏, —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –ø–æ –±–ª–æ–∫—É `catch`
}).catch((error) => {
  console.log('first error happened:');
})
.then((data) => {
  console.log(data); // <- —Å—Ä–∞–±–æ—Ç–∞–µ—Ç `then`
}).catch((error) => {
  console.log('second error happened:'); // <- –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
});

// undefined
```

–ü–æ—á–µ–º—É —Ç–∞–∫?

---

## then –∏ catch

–ú–µ—Ç–æ–¥—ã `then` –∏ `catch` —Ç–æ–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `Promise`, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ `Promise`.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ `then`:
* `then` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`
* –µ—Å–ª–∏ –∏–∑ `then` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –æ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled`
* —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –∏–∑ `then` –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è, —Ç–æ –≤ `Promise` –∫–ª–∞–¥—ë—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ `undefined`
* –µ—Å–ª–∏ –≤ `then` –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞, —Ç–æ –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `rejected`
* –µ—Å–ª–∏ –∏–∑ `then` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `Promise`, —Ç–æ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `then` –∏ `catch` –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

---

## then –∏ catch

–ú–µ—Ç–æ–¥—ã `then` –∏ `catch` —Ç–æ–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `Promise`, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ `Promise`.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ `catch`:
* `catch` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`
* –µ—Å–ª–∏ –∏–∑ `catch` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –æ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled`
* —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –∏–∑ `catch` –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è, —Ç–æ –≤ `Promise` –∫–ª–∞–¥—ë—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ `undefined`
* –µ—Å–ª–∏ –≤ `catch` –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞, —Ç–æ –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `rejected`
* –µ—Å–ª–∏ –∏–∑ `catch` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `Promise`, —Ç–æ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `then` –∏ `catch` –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

---

## –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã Promise

–ö–ª–∞—Å—Å `Promise` —Å–æ–¥–µ—Ä–∂–∏—Ç –µ—â—ë —Ä—è–¥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö —É–¥–æ–±–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
* `Promise.all(iterable)` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled`, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ `Promise` –∏–∑ `iterable` –ø–µ—Ä–µ—à–ª–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfiled` (–ª–∏–±–æ –≤ `iterable` –Ω–µ –±—ã–ª–æ `Promise` )
* `Promise.race(iterable)` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled` –∏–ª–∏ `rejected` –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ª—é–±–æ–π –∏–∑ `Promise`, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö—Å—è –≤ `iterable` –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `fullfilled` –∏–ª–∏ `rejected`

---

## async/await

–° `Promise` –≤—Å—ë –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å –ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –µ—â—ë –±–æ–ª–µ–µ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–¥?

–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ `async`/`await` –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å `Promise` –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–π.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ä–∞–∑—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ.

---

## async/await

```javascript
const response = await getResponse(args);
const data = await processResponse(response);
```

–ò —ç—Ç–æ –≤–º–µ—Å—Ç–æ:
```javascript
const promise = getResponse();
promise.then((response) => {
  return processResponse(response);
.then((data) => {
  // Do something
});
```

–£–¥–æ–±–Ω–æ?

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ finally

–ó–¥–µ—Å—å —Ç–æ–∂–µ –≤—Å—ë —Ö–æ—Ä–æ—à–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `try...catch...finally`

```javascript
try {
  const response = await getResponse(args);
  const data = await processResponse(response);
} catch {
  ...
} finally {
  ...
}
```

---

## async

–ù–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `await` –µ—Å—Ç—å –æ–¥–Ω–æ –∫–ª—é—á–µ–≤–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: `await` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `async` —Ñ—É–Ω–∫—Ü–∏–π:

```javascript
(async () => {
  try {
    const response = await getResponse(args);
    const data = await processResponse(response);
  } catch {
    ...
  } finally {
    ...
  }
})();
```

---

## async

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `async` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ - —Ç.–µ. –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise`, –Ω–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è.

–ß—Ç–æ –∑–Ω–∞—á–∏—Ç *–∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è*? –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤—ã –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç–µ –∏–∑ —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–æ –æ–Ω–æ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ `Promise`.

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `await` –≤–Ω—É—Ç—Ä–∏ `async` —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥–∞ `Promise` (`await` —Å—Ç–∞–≤–∏—Ç—Å—è –ø–µ—Ä–µ–¥ `Promise`) –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `fullfilled` –∏–ª–∏ `rejected`.

## –î–ª—è —á–µ–≥–æ —ç—Ç–æ?

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞, —Å—Ä–∞–≤–Ω–∏–º:
```javascript
(async () => {
  try {
    // –æ–∂–∏–¥–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è `Promise`
    const response = await getResponse(args);
    // –æ–∂–∏–¥–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è `Promise`
    const data = await processResponse(response);
  } catch {
    ...
  } finally {
    ...
  }
})();
```

```javascript
getResponse(args).then((response) => {
  return processResponse(response);
}).then((data) => {
  // do something
}).catch((error) => {
  // handle error
}).finally(() => {
  // final handlings
})
```

–ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π –∑–∞ —Å—á—ë—Ç —Ç–æ–≥–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–∞–≥—Ä–æ–º–æ–∂–¥–µ–Ω–∏—è `then`, `catch`.

---

## async/await

–ü–æ—á–µ–º—É –±—ã —Ç–æ–≥–¥–∞ —Å–æ–≤—Å–µ–º –Ω–µ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç `Promise`?

> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –æ—Å–Ω–æ–≤–µ —Ä–∞–±–æ—Ç—ã `async`/`await` –ª–µ–∂–∞—Ç `Promise`. `async`/`await` –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ª–∏—à—å —É–¥–æ–±–Ω–µ–µ —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å.

---

## async/await & Promise

async/await –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Å–≤—è–∑–∫–µ —Å Promise

"–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ" –∑–∞–ø—Ä–æ—Å—ã:
```javascript
const [resp1, resp2] = await Promise.all(
  getResponse(<from server1>), getResponse(<from server2>)
);
```

```javascript
await getResponse(<from server1>);
await getResponse(<from server2>);
```

---

## Babel

```shell=
$ npm install @babel/polyfill
```

–í `.babelrc`:
```json=
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "useBuiltIns": "usage"
      }
    ]
  ]
}
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

Jest –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –Ω–∞–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (callback'–∏, `Promise`, `async`/`await`) —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏—Ö.

---

## Callbacks

```javascript
test('should call our callback', (done) => { // <- —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç
  getData((data) => {
    expect(data).toEqual(...);
    done(); // <- —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
  });
});
```

`done` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑–æ–≤–∞ –∫–æ—Ç–æ—Ä–æ–π Jest –±—É–¥–µ—Ç –æ–∂–∏–¥–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ `jest.setTimeout` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - 5 —Å–µ–∫—É–Ω–¥).

–ï—Å–ª–∏ –≤—ã–∑–æ–≤–∞ –Ω–µ –±—É–¥–µ—Ç, –ø–æ–ª—É—á–∏–º `FAIL`

![](https://i.imgur.com/TCCl9UF.png)

---

## Promise –∏ async/await

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å `Promise` –∏ `async`/`await` –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω–æ):
```javascript
test('should work with promise and async/await', async () => { // <- async
  const data = await getData();
  expect(data).toEqual(...);
});
```

---

## Error handling

```javascript
test('should handle errors', async () => { // <- async
  // <- —Å–æ–æ–±—â–∞–µ–º Jest, —á—Ç–æ —É –Ω–∞—Å –æ–¥–∏–Ω assert, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
  expect.assertions(1);
  try {
    const data = await getData();
  } catch (e) {
    expect(e).toEqual(...); // <- –ø–æ–¥—É–º–∞–π—Ç–µ, –∫–∞–∫–æ–π –º–∞—Ç—á–µ—Ä –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
  }
});
```

---

## –ò—Ç–æ–≥–∏

–°–µ–≥–æ–¥–Ω—è –º—ã —Å –≤–∞–º–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ –≤–∞–∂–Ω—ã—Ö –≤–µ—â–µ–π:
1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
1. Promises
1. async/await
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

---

## –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! –í—Ä–µ–º—è –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã üôÇ

---